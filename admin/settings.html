<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Redstone Admin</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Admin CSS -->
    <link rel="stylesheet" href="../css/admin.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h1><span>REDSTONE</span> ADMIN</h1>
        </div>

        <nav class="sidebar-nav">
            <a href="index.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </a>
            <a href="products.html" class="nav-item">
                <i class="fas fa-box"></i>
                <span>Products</span>
            </a>
            <a href="orders.html" class="nav-item">
                <i class="fas fa-shopping-bag"></i>
                <span>Orders</span>
            </a>
            <a href="customers.html" class="nav-item">
                <i class="fas fa-users"></i>
                <span>Customers</span>
            </a>
            <a href="categories.html" class="nav-item">
                <i class="fas fa-tags"></i>
                <span>Categories</span>
            </a>
            <a href="settings.html" class="nav-item active">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <a href="../index.html" class="nav-item">
                <i class="fas fa-store"></i>
                <span>View Store</span>
            </a>
            <a href="#" class="nav-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="top-bar">
            <button class="menu-toggle" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>

            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search settings...">
            </div>

            <div class="top-bar-actions">
                <button class="icon-btn">
                    <i class="fas fa-bell"></i>
                    <span class="badge">3</span>
                </button>

                <div class="user-menu">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=7800ff&color=fff" alt="Admin">
                    <span>Admin</span>
                </div>
            </div>
        </header>

        <!-- Settings Content -->
        <div class="content">
            <div class="page-header">
                <div>
                    <h1>Settings</h1>
                    <p>Manage your store settings</p>
                </div>
            </div>

            <!-- Settings Tabs -->
            <div class="settings-tabs">
                <button class="tab-btn active" onclick="showTab('general')">
                    <i class="fas fa-store"></i> General
                </button>
                <button class="tab-btn" onclick="showTab('currency')">
                    <i class="fas fa-dollar-sign"></i> Currency
                </button>
                <button class="tab-btn" onclick="showTab('shipping')">
                    <i class="fas fa-truck"></i> Shipping
                </button>
                <button class="tab-btn" onclick="showTab('payments')">
                    <i class="fas fa-credit-card"></i> Payments
                </button>
                <button class="tab-btn" onclick="showTab('account')">
                    <i class="fas fa-user-cog"></i> Account
                </button>
            </div>

            <!-- General Settings -->
            <div class="settings-panel active" id="general-panel">
                <div class="card">
                    <div class="card-header">
                        <h2>Store Information</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Store Name</label>
                            <input type="text" class="form-input" id="store-name" value="Redstone Store">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Store Email</label>
                            <input type="email" class="form-input" id="store-email" value="contact@redstone.com">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Store Phone</label>
                            <input type="tel" class="form-input" id="store-phone" value="+92 300 1234567">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Store Address</label>
                            <textarea class="form-textarea" id="store-address" rows="2">123 Main Street, Lahore, Pakistan</textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Store Description</label>
                            <textarea class="form-textarea" id="store-description" rows="3">Your one-stop shop for electronics, fashion, and digital products.</textarea>
                        </div>
                        <button class="btn btn-primary" onclick="saveGeneralSettings()">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </div>
            </div>

            <!-- Currency Settings -->
            <div class="settings-panel" id="currency-panel">
                <div class="card">
                    <div class="card-header">
                        <h2>Currency Settings</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Default Currency</label>
                            <select class="form-select" id="default-currency">
                                <option value="PKR" selected>Pakistani Rupee (PKR)</option>
                                <option value="USD">US Dollar (USD)</option>
                                <option value="EUR">Euro (EUR)</option>
                                <option value="GBP">British Pound (GBP)</option>
                            </select>
                        </div>

                        <h3 style="margin: 30px 0 20px;">Exchange Rates (relative to PKR)</h3>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">USD Rate</label>
                                <input type="number" class="form-input" id="usd-rate" value="0.0036" step="0.0001">
                            </div>
                            <div class="form-group">
                                <label class="form-label">EUR Rate</label>
                                <input type="number" class="form-input" id="eur-rate" value="0.0033" step="0.0001">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">GBP Rate</label>
                                <input type="number" class="form-input" id="gbp-rate" value="0.0028" step="0.0001">
                            </div>
                            <div class="form-group">
                                <label class="form-label">AED Rate</label>
                                <input type="number" class="form-input" id="aed-rate" value="0.013" step="0.0001">
                            </div>
                        </div>

                        <button class="btn btn-primary" onclick="saveCurrencySettings()">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </div>
            </div>

            <!-- Shipping Settings -->
            <div class="settings-panel" id="shipping-panel">
                <div class="card">
                    <div class="card-header">
                        <h2>Shipping Settings</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Free Shipping Threshold (PKR)</label>
                            <input type="number" class="form-input" id="free-shipping" value="5000">
                            <small style="color: #888;">Orders above this amount get free shipping</small>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Standard Shipping Rate (PKR)</label>
                            <input type="number" class="form-input" id="standard-shipping" value="300">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Express Shipping Rate (PKR)</label>
                            <input type="number" class="form-input" id="express-shipping" value="500">
                        </div>

                        <h3 style="margin: 30px 0 20px;">Shipping Zones</h3>

                        <div class="shipping-zones" id="shipping-zones">
                            <div class="shipping-zone">
                                <div class="zone-header">
                                    <span>Pakistan (Domestic)</span>
                                    <span class="zone-rate">Rs.300</span>
                                </div>
                            </div>
                            <div class="shipping-zone">
                                <div class="zone-header">
                                    <span>International</span>
                                    <span class="zone-rate">Rs.2500</span>
                                </div>
                            </div>
                        </div>

                        <button class="btn btn-primary" onclick="saveShippingSettings()">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </div>
            </div>

            <!-- Payment Settings -->
            <div class="settings-panel" id="payments-panel">
                <div class="card">
                    <div class="card-header">
                        <h2>Payment Methods</h2>
                    </div>
                    <div class="card-body">
                        <div class="payment-method-item">
                            <div class="method-info">
                                <i class="fas fa-credit-card"></i>
                                <div>
                                    <h4>Credit/Debit Card</h4>
                                    <p>Accept Visa, Mastercard, and other cards</p>
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="card-enabled" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="payment-method-item">
                            <div class="method-info">
                                <i class="fas fa-money-bill"></i>
                                <div>
                                    <h4>Cash on Delivery</h4>
                                    <p>Pay when you receive your order</p>
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="cod-enabled" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="payment-method-item">
                            <div class="method-info">
                                <i class="fas fa-mobile-alt"></i>
                                <div>
                                    <h4>JazzCash</h4>
                                    <p>Mobile wallet payment</p>
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="jazzcash-enabled" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="payment-method-item">
                            <div class="method-info">
                                <i class="fab fa-paypal"></i>
                                <div>
                                    <h4>PayPal</h4>
                                    <p>International payments via PayPal</p>
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="paypal-enabled" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <button class="btn btn-primary" onclick="savePaymentSettings()">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </div>
            </div>

            <!-- Account Settings -->
            <div class="settings-panel" id="account-panel">
                <div class="card">
                    <div class="card-header">
                        <h2>Admin Account</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Admin Name</label>
                            <input type="text" class="form-input" id="admin-name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Admin Email</label>
                            <input type="email" class="form-input" id="admin-email">
                        </div>

                        <h3 style="margin: 30px 0 20px;">Change Password</h3>

                        <div class="form-group">
                            <label class="form-label">Current Password</label>
                            <input type="password" class="form-input" id="current-password">
                        </div>
                        <div class="form-group">
                            <label class="form-label">New Password</label>
                            <input type="password" class="form-input" id="new-password">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Confirm New Password</label>
                            <input type="password" class="form-input" id="confirm-password">
                        </div>

                        <button class="btn btn-primary" onclick="saveAccountSettings()">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <div class="card-header">
                        <h2>Danger Zone</h2>
                    </div>
                    <div class="card-body">
                        <div class="danger-action">
                            <div>
                                <h4>Reset Store Data</h4>
                                <p>Delete all products, orders, and customers. This cannot be undone.</p>
                            </div>
                            <button class="btn btn-danger" onclick="resetStoreData()">Reset Data</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <!-- Admin JS -->
    <script src="../js/admin.js"></script>
    <script>
        // Check authentication
        checkAuth();

        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
        });

        function showTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Update panels
            document.querySelectorAll('.settings-panel').forEach(panel => panel.classList.remove('active'));
            document.getElementById(tabName + '-panel').classList.add('active');
        }

        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('storeSettings') || '{}');
            const admin = JSON.parse(localStorage.getItem('currentAdmin') || '{}');

            // Load general settings
            if (settings.storeName) document.getElementById('store-name').value = settings.storeName;
            if (settings.storeEmail) document.getElementById('store-email').value = settings.storeEmail;
            if (settings.storePhone) document.getElementById('store-phone').value = settings.storePhone;
            if (settings.storeAddress) document.getElementById('store-address').value = settings.storeAddress;
            if (settings.storeDescription) document.getElementById('store-description').value = settings.storeDescription;

            // Load currency settings
            if (settings.defaultCurrency) document.getElementById('default-currency').value = settings.defaultCurrency;
            if (settings.usdRate) document.getElementById('usd-rate').value = settings.usdRate;
            if (settings.eurRate) document.getElementById('eur-rate').value = settings.eurRate;
            if (settings.gbpRate) document.getElementById('gbp-rate').value = settings.gbpRate;
            if (settings.aedRate) document.getElementById('aed-rate').value = settings.aedRate;

            // Load shipping settings
            if (settings.freeShipping) document.getElementById('free-shipping').value = settings.freeShipping;
            if (settings.standardShipping) document.getElementById('standard-shipping').value = settings.standardShipping;
            if (settings.expressShipping) document.getElementById('express-shipping').value = settings.expressShipping;

            // Load payment settings
            if (settings.cardEnabled !== undefined) document.getElementById('card-enabled').checked = settings.cardEnabled;
            if (settings.codEnabled !== undefined) document.getElementById('cod-enabled').checked = settings.codEnabled;
            if (settings.jazzcashEnabled !== undefined) document.getElementById('jazzcash-enabled').checked = settings.jazzcashEnabled;
            if (settings.paypalEnabled !== undefined) document.getElementById('paypal-enabled').checked = settings.paypalEnabled;

            // Load admin settings
            if (admin.name) document.getElementById('admin-name').value = admin.name;
            if (admin.email) document.getElementById('admin-email').value = admin.email;
        }

        function saveGeneralSettings() {
            const settings = JSON.parse(localStorage.getItem('storeSettings') || '{}');
            settings.storeName = document.getElementById('store-name').value;
            settings.storeEmail = document.getElementById('store-email').value;
            settings.storePhone = document.getElementById('store-phone').value;
            settings.storeAddress = document.getElementById('store-address').value;
            settings.storeDescription = document.getElementById('store-description').value;
            localStorage.setItem('storeSettings', JSON.stringify(settings));
            showToast('General settings saved successfully', 'success');
        }

        function saveCurrencySettings() {
            const settings = JSON.parse(localStorage.getItem('storeSettings') || '{}');
            settings.defaultCurrency = document.getElementById('default-currency').value;
            settings.usdRate = parseFloat(document.getElementById('usd-rate').value);
            settings.eurRate = parseFloat(document.getElementById('eur-rate').value);
            settings.gbpRate = parseFloat(document.getElementById('gbp-rate').value);
            settings.aedRate = parseFloat(document.getElementById('aed-rate').value);
            localStorage.setItem('storeSettings', JSON.stringify(settings));
            showToast('Currency settings saved successfully', 'success');
        }

        function saveShippingSettings() {
            const settings = JSON.parse(localStorage.getItem('storeSettings') || '{}');
            settings.freeShipping = parseInt(document.getElementById('free-shipping').value);
            settings.standardShipping = parseInt(document.getElementById('standard-shipping').value);
            settings.expressShipping = parseInt(document.getElementById('express-shipping').value);
            localStorage.setItem('storeSettings', JSON.stringify(settings));
            showToast('Shipping settings saved successfully', 'success');
        }

        function savePaymentSettings() {
            const settings = JSON.parse(localStorage.getItem('storeSettings') || '{}');
            settings.cardEnabled = document.getElementById('card-enabled').checked;
            settings.codEnabled = document.getElementById('cod-enabled').checked;
            settings.jazzcashEnabled = document.getElementById('jazzcash-enabled').checked;
            settings.paypalEnabled = document.getElementById('paypal-enabled').checked;
            localStorage.setItem('storeSettings', JSON.stringify(settings));
            showToast('Payment settings saved successfully', 'success');
        }

        function saveAccountSettings() {
            const admin = JSON.parse(localStorage.getItem('currentAdmin') || '{}');
            const adminUsers = JSON.parse(localStorage.getItem('adminUsers') || '[]');

            const newName = document.getElementById('admin-name').value;
            const newEmail = document.getElementById('admin-email').value;
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            // Update name and email
            admin.name = newName;
            admin.email = newEmail;

            // Handle password change
            if (newPassword) {
                if (currentPassword !== admin.password) {
                    showToast('Current password is incorrect', 'error');
                    return;
                }
                if (newPassword !== confirmPassword) {
                    showToast('New passwords do not match', 'error');
                    return;
                }
                admin.password = newPassword;
            }

            // Update in admin users array
            const index = adminUsers.findIndex(u => u.id === admin.id);
            if (index !== -1) {
                adminUsers[index] = admin;
            }

            localStorage.setItem('currentAdmin', JSON.stringify(admin));
            localStorage.setItem('adminUsers', JSON.stringify(adminUsers));

            // Clear password fields
            document.getElementById('current-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';

            showToast('Account settings saved successfully', 'success');
        }

        function resetStoreData() {
            if (confirm('Are you sure you want to reset all store data? This action cannot be undone!')) {
                if (confirm('This will delete ALL products, orders, and customers. Continue?')) {
                    localStorage.removeItem('adminProducts');
                    localStorage.removeItem('orders');
                    localStorage.removeItem('users');
                    localStorage.removeItem('adminCategories');
                    showToast('Store data has been reset', 'success');
                    setTimeout(() => {
                        window.location.reload();
                    }, 1500);
                }
            }
        }
    </script>

    <style>
        .settings-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 20px;
            background: rgba(26, 26, 46, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #888;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            border-color: rgba(120, 0, 255, 0.5);
            color: #fff;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, rgba(120, 0, 255, 0.2), rgba(0, 212, 255, 0.2));
            border-color: #7800ff;
            color: #fff;
        }

        .settings-panel {
            display: none;
        }

        .settings-panel.active {
            display: block;
        }

        .card-body {
            padding: 25px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .payment-method-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .method-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .method-info i {
            font-size: 1.5rem;
            color: #7800ff;
            width: 40px;
        }

        .method-info h4 {
            margin-bottom: 5px;
        }

        .method-info p {
            color: #888;
            font-size: 0.9rem;
            margin: 0;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 26px;
            transition: 0.3s;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background: #fff;
            border-radius: 50%;
            transition: 0.3s;
        }

        .toggle-switch input:checked + .toggle-slider {
            background: linear-gradient(135deg, #7800ff, #00d4ff);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        .shipping-zone {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 10px;
        }

        .zone-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .zone-rate {
            color: #00d4ff;
            font-weight: 600;
        }

        .danger-action {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid rgba(255, 71, 87, 0.3);
            border-radius: 8px;
        }

        .danger-action h4 {
            color: #ff4757;
            margin-bottom: 5px;
        }

        .danger-action p {
            color: #888;
            font-size: 0.9rem;
            margin: 0;
        }

        .btn-danger {
            background: #ff4757;
        }

        .btn-danger:hover {
            background: #ee3a4a;
        }
    </style>
</body>
</html>
